# flow

[[tasks]]
name = "build-sync"
command = "bun build sync/src/main.ts --compile --outfile ~/.local/bin/sync"
description = "Build sync CLI binary"

[[tasks]]
name = "setup"
command = "./sh/check-config-setup.sh"
description = "Verify repo location and required symlinks"
dependencies = ["ensure-sh", "ensure-ssh-config"]

[[tasks]]
name = "ensure-ssh-config"
command = "f -p i setup"
description = "Ensure ~/.ssh/config points to repo-managed config"

[[tasks]]
name = "ensure-sh"
command = "bash -c 'set -eu; if [ -d sh/.git ]; then git -C sh remote get-url origin >/dev/null 2>&1 || { echo \"[x] sh repo exists but origin is missing\" >&2; exit 1; }; echo \"[ok] sh repo present\"; elif [ -e sh ]; then echo \"[x] sh directory exists but is not a git repo. Remove or rename it, then rerun task setup.\" >&2; exit 1; else echo \"[info] cloning https://github.com/nikivdev/sh.git into ./sh\"; git clone https://github.com/nikivdev/sh.git sh; fi'"
description = "Ensure nikivdev/sh repo is present"
